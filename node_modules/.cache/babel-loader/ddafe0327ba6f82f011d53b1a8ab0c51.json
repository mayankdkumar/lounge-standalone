{"ast":null,"code":"var _jsxFileName = \"D:\\\\development\\\\torum\\\\webRTC-advanced (1)\\\\webRTC-advanced\\\\to-be-deployed\\\\my-app\\\\src\\\\RoomPage\\\\VideoSection\\\\SwitchToScreenSharingButton.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport SwitchImg from \"../../resources/images/switchToScreenSharing.svg\";\nimport LocalScreenSharingPreview from \"./LocalScreenSharingPreview\";\nimport * as webRTCHandler from \"../../utils/webRTCHandler\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst constraints = {\n  audio: false,\n  video: true\n};\n\nconst SwitchToScreenSharingButton = () => {\n  _s();\n\n  const [isScreenSharingActive, setIsScreenSharingActive] = useState(false);\n  const [screenSharingStream, setScreenSharingStream] = useState(null);\n\n  const handleScreenShareToggle = async () => {\n    if (!isScreenSharingActive) {\n      let stream = null;\n\n      try {\n        stream = await navigator.mediaDevices.getDisplayMedia(constraints);\n      } catch (err) {\n        console.log(\"error occurred when trying to get an access to screen share stream\");\n      }\n\n      if (stream) {\n        setScreenSharingStream(stream);\n        webRTCHandler.toggleScreenShare(isScreenSharingActive, stream);\n        setIsScreenSharingActive(true); // execute here function to switch the video track which we are sending to other users\n      }\n    } else {\n      webRTCHandler.toggleScreenShare(isScreenSharingActive);\n      setIsScreenSharingActive(false); // stop screen share stream\n\n      screenSharingStream.getTracks().forEach(t => t.stop());\n      setScreenSharingStream(null);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video_button_container\",\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: SwitchImg,\n        onClick: handleScreenShareToggle,\n        className: \"video_button_image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), isScreenSharingActive && /*#__PURE__*/_jsxDEV(LocalScreenSharingPreview, {\n      stream: screenSharingStream\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(SwitchToScreenSharingButton, \"EDNK554F9kzm0rl1iVOi1mTRTYk=\");\n\n_c = SwitchToScreenSharingButton;\nexport default SwitchToScreenSharingButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"SwitchToScreenSharingButton\");","map":{"version":3,"sources":["D:/development/torum/webRTC-advanced (1)/webRTC-advanced/to-be-deployed/my-app/src/RoomPage/VideoSection/SwitchToScreenSharingButton.js"],"names":["React","useState","LocalScreenSharingPreview","webRTCHandler","constraints","audio","video","SwitchToScreenSharingButton","isScreenSharingActive","setIsScreenSharingActive","screenSharingStream","setScreenSharingStream","handleScreenShareToggle","stream","navigator","mediaDevices","getDisplayMedia","err","console","log","toggleScreenShare","getTracks","forEach","t","stop","SwitchImg"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;;AAEA,OAAOC,yBAAP,MAAsC,6BAAtC;AACA,OAAO,KAAKC,aAAZ,MAA+B,2BAA/B;;;AAEA,MAAMC,WAAW,GAAG;AAClBC,EAAAA,KAAK,EAAE,KADW;AAElBC,EAAAA,KAAK,EAAE;AAFW,CAApB;;AAKA,MAAMC,2BAA2B,GAAG,MAAM;AAAA;;AACxC,QAAM,CAACC,qBAAD,EAAwBC,wBAAxB,IAAoDR,QAAQ,CAAC,KAAD,CAAlE;AACA,QAAM,CAACS,mBAAD,EAAsBC,sBAAtB,IAAgDV,QAAQ,CAAC,IAAD,CAA9D;;AAEA,QAAMW,uBAAuB,GAAG,YAAY;AAC1C,QAAI,CAACJ,qBAAL,EAA4B;AAC1B,UAAIK,MAAM,GAAG,IAAb;;AACA,UAAI;AACFA,QAAAA,MAAM,GAAG,MAAMC,SAAS,CAACC,YAAV,CAAuBC,eAAvB,CAAuCZ,WAAvC,CAAf;AACD,OAFD,CAEE,OAAOa,GAAP,EAAY;AACZC,QAAAA,OAAO,CAACC,GAAR,CACE,oEADF;AAGD;;AACD,UAAIN,MAAJ,EAAY;AACVF,QAAAA,sBAAsB,CAACE,MAAD,CAAtB;AAEAV,QAAAA,aAAa,CAACiB,iBAAd,CAAgCZ,qBAAhC,EAAuDK,MAAvD;AACAJ,QAAAA,wBAAwB,CAAC,IAAD,CAAxB,CAJU,CAKV;AACD;AACF,KAhBD,MAgBO;AACLN,MAAAA,aAAa,CAACiB,iBAAd,CAAgCZ,qBAAhC;AACAC,MAAAA,wBAAwB,CAAC,KAAD,CAAxB,CAFK,CAIL;;AACAC,MAAAA,mBAAmB,CAACW,SAApB,GAAgCC,OAAhC,CAAyCC,CAAD,IAAOA,CAAC,CAACC,IAAF,EAA/C;AACAb,MAAAA,sBAAsB,CAAC,IAAD,CAAtB;AACD;AACF,GAzBD;;AA2BA,sBACE;AAAA,4BACE;AAAK,MAAA,SAAS,EAAC,wBAAf;AAAA,6BACE;AACE,QAAA,GAAG,EAAEc,SADP;AAEE,QAAA,OAAO,EAAEb,uBAFX;AAGE,QAAA,SAAS,EAAC;AAHZ;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF,EAQGJ,qBAAqB,iBACpB,QAAC,yBAAD;AAA2B,MAAA,MAAM,EAAEE;AAAnC;AAAA;AAAA;AAAA;AAAA,YATJ;AAAA,kBADF;AAcD,CA7CD;;GAAMH,2B;;KAAAA,2B;AA+CN,eAAeA,2BAAf","sourcesContent":["import React, { useState } from \"react\";\r\nimport SwitchImg from \"../../resources/images/switchToScreenSharing.svg\";\r\nimport LocalScreenSharingPreview from \"./LocalScreenSharingPreview\";\r\nimport * as webRTCHandler from \"../../utils/webRTCHandler\";\r\n\r\nconst constraints = {\r\n  audio: false,\r\n  video: true,\r\n};\r\n\r\nconst SwitchToScreenSharingButton = () => {\r\n  const [isScreenSharingActive, setIsScreenSharingActive] = useState(false);\r\n  const [screenSharingStream, setScreenSharingStream] = useState(null);\r\n\r\n  const handleScreenShareToggle = async () => {\r\n    if (!isScreenSharingActive) {\r\n      let stream = null;\r\n      try {\r\n        stream = await navigator.mediaDevices.getDisplayMedia(constraints);\r\n      } catch (err) {\r\n        console.log(\r\n          \"error occurred when trying to get an access to screen share stream\"\r\n        );\r\n      }\r\n      if (stream) {\r\n        setScreenSharingStream(stream);\r\n\r\n        webRTCHandler.toggleScreenShare(isScreenSharingActive, stream);\r\n        setIsScreenSharingActive(true);\r\n        // execute here function to switch the video track which we are sending to other users\r\n      }\r\n    } else {\r\n      webRTCHandler.toggleScreenShare(isScreenSharingActive);\r\n      setIsScreenSharingActive(false);\r\n\r\n      // stop screen share stream\r\n      screenSharingStream.getTracks().forEach((t) => t.stop());\r\n      setScreenSharingStream(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"video_button_container\">\r\n        <img\r\n          src={SwitchImg}\r\n          onClick={handleScreenShareToggle}\r\n          className=\"video_button_image\"\r\n        />\r\n      </div>\r\n      {isScreenSharingActive && (\r\n        <LocalScreenSharingPreview stream={screenSharingStream} />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SwitchToScreenSharingButton;\r\n"]},"metadata":{},"sourceType":"module"}